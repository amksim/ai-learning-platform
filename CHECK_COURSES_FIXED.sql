-- üîç –ü–†–û–í–ï–†–ö–ê –ö–£–†–°–û–í - –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø
-- –°–Ω–∞—á–∞–ª–∞ —Å–º–æ—Ç—Ä–∏–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã, –ø–æ—Ç–æ–º –ø—Ä–æ–≤–µ—Ä—è–µ–º –∫—É—Ä—Å—ã

-- ============================================
-- –®–ê–ì 1: –°–¢–†–£–ö–¢–£–†–ê –¢–ê–ë–õ–ò–¶–´ COURSES
-- ============================================

-- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏ –µ—Å—Ç—å –≤ —Ç–∞–±–ª–∏—Ü–µ
SELECT 
  column_name,
  data_type,
  is_nullable
FROM information_schema.columns
WHERE table_name = 'courses'
ORDER BY ordinal_position;

-- ============================================
-- –®–ê–ì 2: –ü–û–ö–ê–ó–ê–¢–¨ –í–°–ï –ö–£–†–°–´ (–ü–†–û–°–¢–ê–Ø –í–ï–†–°–ò–Ø)
-- ============================================

-- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –∫—É—Ä—Å—ã —Å –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
SELECT 
  id,
  title,
  CASE 
    WHEN LENGTH(description) > 50 THEN LEFT(description, 50) || '...'
    ELSE description 
  END as description_preview,
  LENGTH(description) as description_length,
  is_free,
  course_category_id,
  created_at::date as created_date
FROM courses
ORDER BY id;

-- ============================================
-- –®–ê–ì 3: –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–û –î–õ–ò–ù–ï –û–ü–ò–°–ê–ù–ò–Ø
-- ============================================

-- –°–∫–æ–ª—å–∫–æ –∫—É—Ä—Å–æ–≤ —Å –¥–ª–∏–Ω–Ω—ã–º –∏ –∫–æ—Ä–æ—Ç–∫–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ–º
SELECT 
  CASE 
    WHEN LENGTH(description) > 100 THEN '–î–ª–∏–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (>100)'
    WHEN LENGTH(description) > 50 THEN '–°—Ä–µ–¥–Ω–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (50-100)'
    ELSE '–ö–æ—Ä–æ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (<50)'
  END as description_type,
  COUNT(*) as count
FROM courses
GROUP BY 
  CASE 
    WHEN LENGTH(description) > 100 THEN '–î–ª–∏–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (>100)'
    WHEN LENGTH(description) > 50 THEN '–°—Ä–µ–¥–Ω–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (50-100)'
    ELSE '–ö–æ—Ä–æ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (<50)'
  END
ORDER BY COUNT(*) DESC;

-- ============================================
-- –®–ê–ì 4: –ö–£–†–°–´ –° –î–õ–ò–ù–ù–´–ú –û–ü–ò–°–ê–ù–ò–ï–ú (–•–û–†–û–®–ò–ï)
-- ============================================

-- –≠—Ç–æ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ —Ç–≤–æ–∏ 14 –∫—É—Ä—Å–æ–≤ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É
SELECT 
  id,
  title,
  '–•–û–†–û–®–ò–ô - –û–°–¢–ê–í–ò–¢–¨ ‚úÖ' as status,
  LENGTH(description) as desc_length,
  is_free,
  course_category_id
FROM courses
WHERE LENGTH(description) > 100  -- –ï—Å—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
ORDER BY id;

-- ============================================
-- –®–ê–ì 5: –ö–£–†–°–´ –° –ö–û–†–û–¢–ö–ò–ú –û–ü–ò–°–ê–ù–ò–ï–ú (–°–¢–ê–†–´–ï)
-- ============================================

-- –≠—Ç–æ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ —Å—Ç–∞—Ä—ã–µ 197 –∫—É—Ä—Å–æ–≤
SELECT 
  id,
  title,
  '–ü–£–°–¢–û–ô - –£–î–ê–õ–ò–¢–¨? ‚ùå' as status,
  LENGTH(description) as desc_length,
  is_free,
  course_category_id
FROM courses
WHERE LENGTH(description) <= 100  -- –ö–æ—Ä–æ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
ORDER BY id;

-- ============================================
-- –®–ê–ì 6: –û–ë–©–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê
-- ============================================

SELECT 
  '–í—Å–µ–≥–æ –∫—É—Ä—Å–æ–≤' as type,
  COUNT(*) as count
FROM courses

UNION ALL

SELECT 
  '–° –¥–ª–∏–Ω–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º (>100)' as type,
  COUNT(*) as count
FROM courses 
WHERE LENGTH(description) > 100

UNION ALL

SELECT 
  '–° –∫–æ—Ä–æ—Ç–∫–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ–º (<=100)' as type,
  COUNT(*) as count
FROM courses 
WHERE LENGTH(description) <= 100;

-- ============================================
-- –ì–û–¢–û–í–û! üìä
-- ============================================
-- –ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
-- - –ö—É—Ä—Å—ã —Å –¥–ª–∏–Ω–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º - —ç—Ç–æ —Ç–≤–æ–∏ (–û–°–¢–ê–í–ò–¢–¨)
-- - –ö—É—Ä—Å—ã —Å –∫–æ—Ä–æ—Ç–∫–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ–º - —ç—Ç–æ —Å—Ç–∞—Ä—ã–µ (–£–î–ê–õ–ò–¢–¨)
-- 
-- –ï—Å–ª–∏ –≤—Å—ë –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–π SAFE_DELETE_OLD_COURSES_FIXED.sql
